<html>
        <head>
                <link rel="stylesheet" href="http://leaflet.cloudmade.com/dist/leaflet.css" />

<title>OpenLayers + MapQuest</title>
<script src="http://leaflet.cloudmade.com/dist/leaflet.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script type="text/javascript">
    var map;
    var mapquestUrl;
    var mapquest;
    var taxis=[];
    var leuven = {lat: 50.856024, lng: 4.6923};

    function init(){
        map = new L.Map('map');
        mapquestUrl = 'http://{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png';
        subDomains = ['otile1','otile2','otile3','otile4'];
        mapquestAttrib = 'Data, imagery and map information provided by <a href="http://open.mapquest.co.uk" target="_blank">MapQuest</a>, <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> and contributors.';

        mapquest = new L.TileLayer(mapquestUrl, {maxZoom: 18, attribution: mapquestAttrib, subdomains: subDomains});
        map.addLayer(mapquest).setView(new L.LatLng(leuven.lat, leuven.lng), 13);
		
        /*
        map.addLayer(mapquest).setView(new L.LatLng(50.856024, 4.6923), 13);

        taxis[1] = new L.Marker(new L.LatLng(50.856024, 4.6923), {clickable:false, draggable:false});
        taxis[0] = new L.Marker(new L.LatLng(50.8582, 4.698), {clickable:false, draggable:false});
 
        for(i=0; i<taxis.length; i++) {
            map.addLayer(taxis[i]);
         }
        */
	    var socket = io.connect('http://young-rain-5105.herokuapp.com/');
	    map.on('click', function(e) {
	    	console.log("clicked at: " + e.latlng.lat + ", " + e.latlng.lng);
	    	socket.emit("createTask", {lat: e.latlng.lat, lng: e.latlng.lng}, function() {
	    		L.marker([e.latlng.lat, e.latlng.lng]).addTo(map);
	    	});
	    	
	    });
    }  

    
</script>
</head>

<body onload="init()">
    <div id="map" style="height:100%; position:absolute; left:0px; width:80%"></div>
    <div id="tasksView" style="height:100%; position:absolute; right:0px; width:20%; background-color:#FFCC00">TASK CREATOR</div>
</body>
</html>
